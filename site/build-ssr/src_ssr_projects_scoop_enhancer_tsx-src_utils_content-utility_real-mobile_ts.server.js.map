{"version":3,"file":"src_ssr_projects_scoop_enhancer_tsx-src_utils_content-utility_real-mobile_ts.server.js","mappings":"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","sources":["webpack://personal-site/./src/ssr/projects/scoop.enhancer.tsx","webpack://personal-site/./src/utils/content-utility/real-mobile.ts"],"sourcesContent":["// src/sections/ScoopEnhancer.tsx\r\nimport { useEffect, useState } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport SplitDragHandler from '../../utils/split-controller';\r\nimport { useTooltipInit } from '../../utils/tooltip/tooltipInit';\r\nimport { applySplitStyle } from '../logic/apply-split-style';\r\n\r\nexport default function ScoopEnhancer() {\r\n  const [host, setHost] = useState<HTMLElement | null>(null);\r\n  const [split, setSplit] = useState(() => (window.innerWidth < 768 ? 55 : 50));\r\n  const [isPortrait, setIsPortrait] = useState(window.innerHeight > window.innerWidth);\r\n\r\n  useTooltipInit();\r\n\r\n  useEffect(() => {\r\n    // Remove SSR preset so JS can control layout without specificity fights\r\n    document.getElementById('scoop-ssr')?.classList.remove('ssr-initial-split');\r\n\r\n    // Upgrade images/videos from SSR medium-quality to high-quality (if provided)\r\n    const img1El = document.querySelector('#scoop-ssr #icecream-media-1') as HTMLImageElement | null;\r\n    const vid2El = document.querySelector('#scoop-ssr #icecream-media-2') as HTMLVideoElement | null;\r\n\r\n    const full1 = img1El?.dataset?.srcFull;\r\n    const full2 = vid2El?.dataset?.srcFull;\r\n\r\n    // Upgrade LEFT media (image)\r\n    if (img1El && full1 && img1El.src !== full1) {\r\n      img1El.src = full1;\r\n    }\r\n\r\n    // Upgrade RIGHT media (video)\r\n    if (vid2El) {\r\n      // If high-quality poster exists, upgrade it before load\r\n      if (full2 && vid2El.poster !== full2) {\r\n        vid2El.poster = full2;\r\n      }\r\n\r\n      // When video has enough data to play, remove poster & play\r\n      const handleLoaded = () => {\r\n        vid2El.removeAttribute('poster');\r\n        setTimeout(() => {\r\n          vid2El.play().catch((err) => {\r\n            console.warn('Autoplay failed:', err);\r\n          });\r\n        }, 150); // delay for smoother visual transition\r\n      };\r\n      vid2El.addEventListener('loadeddata', handleLoaded, { once: true });\r\n\r\n      // Trigger video fetching only if not already loaded/playing\r\n      if (vid2El.readyState === 0) {\r\n        vid2El.preload = 'auto';\r\n        try {\r\n          vid2El.load();\r\n        } catch {\r\n          /* ignore */\r\n        }\r\n      } else {\r\n        vid2El.preload = 'auto';\r\n      }\r\n    }\r\n\r\n    // Set mount host\r\n    setHost(document.getElementById('scoop-enhancer-mount'));\r\n\r\n    // Initial apply\r\n    applySplitStyle(split, isPortrait, {\r\n      m1: 'scoop-media-1-container',\r\n      m2: 'scoop-media-2-container',\r\n    });\r\n\r\n    // Orientation listener\r\n    const onResize = () => {\r\n      const p = window.innerHeight > window.innerWidth;\r\n      setIsPortrait(p);\r\n      applySplitStyle(split, p, {\r\n        m1: 'scoop-media-1-container',\r\n        m2: 'scoop-media-2-container',\r\n      });\r\n    };\r\n    window.addEventListener('resize', onResize, { passive: true });\r\n    return () => window.removeEventListener('resize', onResize);\r\n  }, []); // run once\r\n\r\n  // Keep DOM in sync when split OR orientation changes\r\n  useEffect(() => {\r\n    applySplitStyle(split, isPortrait, {\r\n      m1: 'scoop-media-1-container',\r\n      m2: 'scoop-media-2-container',\r\n    });\r\n  }, [split, isPortrait]);\r\n\r\n  if (!host) return null;\r\n  return createPortal(\r\n    <SplitDragHandler\r\n      split={split}\r\n      setSplit={setSplit}\r\n      ids={{ m1: 'scoop-media-1-container', m2: 'scoop-media-2-container' }}\r\n    />,\r\n    host\r\n  );\r\n}\r\n","// useRealMobileViewport.ts\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport function useRealMobileViewport() {\r\n  const [isRealMobile, setIsRealMobile] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      const touch = navigator.maxTouchPoints > 0;\r\n      const coarse = window.matchMedia?.('(pointer: coarse)').matches ?? false;\r\n      const width = window.innerWidth;\r\n      const ua = navigator.userAgent || navigator.vendor || (window as any).opera;\r\n\r\n      // iOS detection (iPhone / iPad)\r\n      const isIOS = /iPad|iPhone|iPod/.test(ua) ||\r\n        (navigator.platform === 'MacIntel' && touch); // iPadOS pretends to be Mac\r\n\r\n      // Android detection\r\n      const isAndroid = /Android/.test(ua);\r\n\r\n      // Consider it real mobile if:\r\n      // - Touch exists, and viewport is small, or\r\n      // - Known mobile UA\r\n      const realMobile =\r\n        (touch && width <= 1024) ||\r\n        isIOS ||\r\n        isAndroid ||\r\n        coarse;\r\n\r\n      setIsRealMobile(realMobile);\r\n    };\r\n\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    window.addEventListener('orientationchange', checkMobile);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', checkMobile);\r\n      window.removeEventListener('orientationchange', checkMobile);\r\n    };\r\n  }, []);\r\n\r\n  return isRealMobile;\r\n}\r\n"],"names":["useEffect","useState","createPortal","SplitDragHandler","useTooltipInit","applySplitStyle","jsx","_jsx","ScoopEnhancer","host","setHost","split","setSplit","window","innerWidth","isPortrait","setIsPortrait","innerHeight","document","getElementById","classList","remove","img1El","querySelector","vid2El","full1","dataset","srcFull","full2","src","poster","handleLoaded","removeAttribute","setTimeout","play","catch","err","console","warn","addEventListener","once","readyState","preload","load","m1","m2","onResize","p","passive","removeEventListener","ids","useRealMobileViewport","isRealMobile","setIsRealMobile","checkMobile","touch","navigator","maxTouchPoints","coarse","matchMedia","matches","width","ua","userAgent","vendor","opera","isIOS","test","platform","isAndroid","realMobile"],"sourceRoot":""}